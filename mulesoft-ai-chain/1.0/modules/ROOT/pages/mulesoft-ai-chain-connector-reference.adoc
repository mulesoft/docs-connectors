= MuleSoft AI Chain Module Connector Reference

The main class of an extension, is the entry point from which configurations, connection providers, operations and sources are declared.

== Configuration

Default Configuration for MuleSoft AI Chain Connector.

=== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
|Name | String | Name for this configuration. Connectors reference the configuration with this name. | | x
| LLM type a| String a| Large Language Model type:

** Anthropic
** Azure OpenAI
** Mistral AI
** Ollama
** OpenAI
** GroqAI |  | x
| Config Type a| String a| Configuration type:

* Environment Variables
* Configuration JSON  |  | x
| File Path a| String |  |  | x
| Model Name a| String | Supported model for the chosen LLM. |  | x
| Temperature a| Number |Controls the randomness of the output. |  0.7 | 
| LLM timeout a| Number | Timeout for the LLM request. |  60 seconds | 
| LLM timeout unit a| Enumeration, one of:

** NANOSECONDS
** MICROSECONDS
** MILLISECONDS
** SECONDS
** MINUTES
** HOURS
** DAYS |  Time unit to use in the LLM Timeout. |  SECONDS | 
| Max Tokens a| Number | Defines the number of LLM Token to use when generating a response. |  500 | 
| Name a| String | ID used to reference this configuration. |  | x
| Expiration Policy a| <<ExpirationPolicy>> |  Configures the minimum amount of time that a dynamic configuration instance can remain idle before Mule considers it eligible for expiration.   |  | 
|===

== Supported Operations

* <<AgentDefinePromptTemplate>> 
* <<ChatAnswerPrompt>> 
* <<ChatAnswerPromptWithMemory>> 
* <<EmbeddingGetInfoFromStore>> 
* <<EmbeddingGetInfoFromStoreLegacy>> 
* <<ImageGenerate>> 
* <<ImageRead>> 
* <<ImageReadScannedDocuments>> 
* <<RagLoadDocument>> 
* <<SentimentAnalyze>> 
* <<ToolsUseAiService>> 
* <<ToolsUseAiServiceLegacy>> 

== Operations

[[AgentDefinePromptTemplate]]
=== AGENT Define Prompt Template
`<ms-aichain:agent-define-prompt-template>`

Helps in defining an AI Agent configured with a prompt template

==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Dataset a| String |  Refers to the user query to be acted upon |  #[payload] | 
| Template a| String |  Refers to sample template used by LLM to respond adequately to the user queries |  | x
| Instructions a| String |  This provides the LLM on how to understand and respond to the user queries |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

=== For Configurations

* <<Config>> 

=== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 


[[ChatAnswerPrompt]]
=== CHAT Answer Prompt
`<ms-aichain:chat-answer-prompt>`

Implements a simple Chat agent to enable chat with the LLM

=== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Prompt a| String |  User defined prompt query |  #[payload] | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String | Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

=== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

=== For Configurations

* <<Config>> 

=== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 


[[ChatAnswerPromptWithMemory]]
=== CHAT Answer Prompt With Memory
`<ms-aichain:chat-answer-prompt-with-memory>`


Implements a chat memory for a defined LLM as an AI Agent. The memoryName allows the multichannel / profile design.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt |  #[payload] | 
| Memory Name a| String |  Name of the memory to be fetched for further processing by the LLMs |  | x
| Db File Path a| String |  Location of the file containing the memory |  | x
| Max Messages a| Number |  Max messages to be analyzed for that memory. |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingGetInfoFromStore]]
=== EMBEDDING Get Info From Store
`<ms-aichain:embedding-get-info-from-store>`


Reads information via prompt from embedding store (in-Memory), which is imported from the storeName (full path)


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt or query |  #[payload] | 
| Store Name a| String |  Name of the store to be queried |  | x
| Get Latest a| Boolean |  Determines whether the store needs to be freshly fetched from the location |  false | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingGetInfoFromStoreLegacy]]
=== EMBEDDING Get Info From Store Legacy
`<ms-aichain:embedding-get-info-from-store-legacy>`


Reads information via prompt from embedding store (in-Memory), which is imported from the storeName (full path)


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt or query |  #[payload] | 
| Store Name a| String |  Name of the store to be queried |  | x
| Get Latest a| Boolean |  Determines whether the store needs to be freshly fetched from the location |  false | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[ImageGenerate]]
=== IMAGE Generate
`<ms-aichain:image-generate>`

Generates an image based on the prompt in data

==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt |  #[payload] | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:IMAGE_ANALYSIS_FAILURE 
* MS-AICHAIN:IMAGE_GENERATION_FAILURE 
* MS-AICHAIN:IMAGE_PROCESSING_FAILURE 


[[ImageRead]]
=== IMAGE Read
`<ms-aichain:image-read>`


Reads an image from a URL and provides the responses for the user prompts.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt |  #[payload] | 
| Context URL a| String |  Refers to the image URL to be analyzed |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:IMAGE_ANALYSIS_FAILURE 
* MS-AICHAIN:IMAGE_GENERATION_FAILURE 
* MS-AICHAIN:IMAGE_PROCESSING_FAILURE 


[[ImageReadScannedDocuments]]
=== IMAGE Read Scanned Documents
`<ms-aichain:image-read-scanned-documents>`


Reads scanned documents and converts to response as prompted by the user.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt |  #[payload] | 
| File Path a| String |  Path to the file to be analyzed |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<ScannedDocResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:IMAGE_ANALYSIS_FAILURE 
* MS-AICHAIN:IMAGE_GENERATION_FAILURE 
* MS-AICHAIN:IMAGE_PROCESSING_FAILURE 


[[RagLoadDocument]]
=== RAG Load Document
`<ms-aichain:rag-load-document>`


Enables the user to query the doc provided in natural language. The doc will be embedded into in memory vector store.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Defines the query input provided by the user |  #[payload] | 
| Context Path a| String |  Defines the file path which will be embedded |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| File Type a| String |  |  text | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[SentimentAnalyze]]
=== SENTIMENT Analyze
`<ms-aichain:sentiment-analyze>`


Analyzes the sentiment of the user data.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user input which needs to be analyzed |  #[payload] | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 


[[ToolsUseAiService]]
=== TOOLS Use Ai Service
`<ms-aichain:tools-use-ai-service>`


(AI Services) Usage of tools by a defined AI Agent. Provide a list of tools (APIs) with all required information (endpoint, headers, body, method, etc.) to the AI Agent to use it on purpose.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt or query |  #[payload] | 
| Tool Config a| String |  Contains the configuration required by the LLM to enable calling tools |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| <<LlmResponseAttributes>>
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[ToolsUseAiServiceLegacy]]
=== TOOLS Use Ai Service Legacy
`<ms-aichain:tools-use-ai-service-legacy>`


(Legacy) Usage of tools by a defined AI Agent. Provide a list of tools (APIs) with all required information (endpoint, headers, body, method, etc.) to the AI Agent to use it on purpose.


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Configuration | String | Name of the configuration to use. | | x
| Data a| String |  Refers to the user prompt or query |  #[payload] | 
| Tool Config a| String |  Contains the configuration required by the LLM to enable calling tools |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Config Ref a| ConfigurationProvider |  Name of the configuration to use to execute this component. |  | x
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===

==== For Configurations

* <<Config>> 

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingAddDocumentToStore]]
=== EMBEDDING Add Document To Store
`<ms-aichain:embedding-add-document-to-store>`


Add document of type text, any and url to embedding store (in-memory), which is exported to the defined storeName (full path)


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Store Name a| String |  Name of the embedding store |  | x
| Context Path a| String |  Refers to the location of the file to be processed |  | x
| Max Segment Size In Chars a| Number |  Max allowed size of continuous sequence of characters while embedding |  | x
| Max Overlap Size In Chars a| Number |  Max size of overlapping characters allowed while embedding |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| File Type a| String |  |  text | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===

==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingAddFolderToStore]]
=== EMBEDDING Add Folder To Store
`<ms-aichain:embedding-add-folder-to-store>`


Add document of type text, any and url to embedding store (in-memory), which is exported to the defined storeName (full path)

==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Store Name a| String |  Name of the embedding store |  | x
| Context Path a| String |  Refers to the location of the folder to be processed |  | x
| Max Segment Size In Chars a| Number |  Max allowed size of continuous sequence of characters while embedding |  | x
| Max Overlap Size In Chars a| Number |  Max size of overlapping characters allowed while embedding |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| File Type a| String |  |  text | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===


==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingNewStore]]
=== EMBEDDING New Store
`<ms-aichain:embedding-new-store>`


Create a new embedding store (in-memory), which is exported to the defined storeName (full path)


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Store Name a| String |  Name of the embedding store |  | x
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===


==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 


[[EmbeddingQueryFromStore]]
=== EMBEDDING Query From Store
`<ms-aichain:embedding-query-from-store>`


Query information from embedding store (in-Memory), which is imported from the storeName (full path)


==== Parameters

[%header%autowidth.spread]
|===
| Name | Type | Description | Default Value | Required
| Store Name a| String |  Name of the embedding store |  | x
| Question a| String |  Refers to the user prompt or query |  #[payload] | 
| Max Results a| Number |  Max results to retrieve from the store |  | x
| Min Score a| Number |  Filters the response with this minScore |  | x
| Get Latest a| Boolean |  Determines whether the store needs to be freshly fetched from the location |  false | 
| Output Mime Type a| String |  The MIME type of the payload that this operation outputs. |  | 
| Output Encoding a| String |  The encoding of the payload that this operation outputs. |  | 
| Streaming Strategy a| * <<RepeatableInMemoryStream>>
* <<RepeatableFileStoreStream>>
* non-repeatable-stream |  Configures how Mule processes streams. Repeatable streams are the default behavior. |  | 
| Target Variable a| String |  Name of the variable that stores the operation's output. |  | 
| Target Value a| String |  Expression that evaluates the operation's output. The expression outcome is stored in the target variable. |  #[payload] | 
|===

==== Output

[%autowidth.spread]
|===
|Type |Any
| Attributes Type a| Object
|===


==== Throws

* MS-AICHAIN:AI_SERVICES_FAILURE 
* MS-AICHAIN:EMBEDDING_OPERATIONS_FAILURE 
* MS-AICHAIN:FILE_HANDLING_FAILURE 
* MS-AICHAIN:RAG_FAILURE 
* MS-AICHAIN:TOOLS_OPERATION_FAILURE 



== Types

[[ExpirationPolicy]]
=== Expiration Policy

Configures an expiration policy strategy.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Max Idle Time a| Number | Configures the maximum amount of time that a dynamic configuration instance can remain idle before Mule considers it eligible for expiration. |  |
| Time Unit a| Enumeration, one of:

** NANOSECONDS
** MICROSECONDS
** MILLISECONDS
** SECONDS
** MINUTES
** HOURS
** DAYS | Time unit for the *Max Idle Time* field. |  |
|===

[[LlmResponseAttributes]]
=== LLM Response Attributes

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Additional Attributes a| Object |  |  | 
| Token Usage a| <<token-usage>> |  |  | 
|===

[[token-usage]]
=== Token Usage

Token usage metadata returned as attributes.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Input Count a| Number | Number of tokens used to process the input. |  | 
| Output Count a| Number | Number of tokens used to generate the output. |  | 
| Total Count a| Number | Total number of tokens used for input and output. |  | 
|===


[[repeatable-in-memory-stream]]
=== Repeatable In Memory Stream

Configures the in-memory streaming strategy by which the request fails if the data exceeds the MAX buffer size. Always run performance tests to find the optimal buffer size for your specific use case.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Initial Buffer Size a| Number | Initial amount of memory to allocate to the data stream. If the streamed data exceeds this value, the buffer expands by *Buffer Size Increment*, with an upper limit of *Max In Memory Size value*. |  |
| Buffer Size Increment a| Number | Amount by which the buffer size expands if it exceeds its initial size. Setting a value of `0` or lower specifies that the buffer can't expand. |  |
| Max Buffer Size a| Number | The maximum amount of memory to use. If more than that is used then a `STREAM_MAXIMUM_SIZE_EXCEEDED` error is raised. A value lower than or equal to zero means no limit. |  |
| Buffer Unit a| Enumeration, one of:

** BYTE
** KB
** MB
** GB | Unit for the *Initial Buffer Size*, *Buffer Size Increment*, and *Buffer Unit* fields. |  |
|===

[[repeatable-file-store-stream]]
=== Repeatable File Store Stream

Configures the repeatable file-store streaming strategy by which Mule keeps a portion of the stream content in memory. If the stream content is larger than the configured buffer size, Mule backs up the buffer's content to disk and then clears the memory.

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| In Memory Size a| Number a| Maximum amount of memory that the stream can use for data. If the amount of memory exceeds this value, Mule buffers the content to disk. To optimize performance:

* Configure a larger buffer size to avoid the number of times Mule needs to write the buffer on disk. This increases performance, but it also limits the number of concurrent requests your application can process, because it requires additional memory.

* Configure a smaller buffer size to decrease memory load at the expense of response time. |  |
| Buffer Unit a| Enumeration, one of:

** BYTE
** KB
** MB
** GB | Unit for the *In Memory Size* field. |  |
|===

[[ScannedDocResponseAttributes]]
=== Scanned Doc Response Attributes

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Additional Attributes a| Object |  |  | 
| Scanned Doc Attributes a| Array of <<DocResponseAttribute>> |  |  | 
|===

[[DocResponseAttribute]]
=== Doc Response Attribute

[%header,cols="20s,25a,30a,15a,10a"]
|===
| Field | Type | Description | Default Value | Required
| Page a| Number |  |  | 
| Token Usage a| <<token-usage>> |  |  | 
|===


== See Also

* xref:index.adoc
